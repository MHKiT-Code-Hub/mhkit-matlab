var sourceData112 = {"FileName":"/Users/asimms/Desktop/Programming/mhkit_matlab_simms_dev/MHKiT-MATLAB-2/mhkit/tidal/graphics/plot_joint_probability_distribution.m","RawFileContents":["function fig=plot_joint_probability_distribution(Q, width_dir, width_vel, ...","                                        options)","","%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%","%   Creates a polar histogram. Direction angles from binned histogram must","%   be specified such that 0 is north.","%","% Parameters","% ------------","%    data: structure","%","%     data.time: vector","%           days from January 0, 0000 in the proleptic ISO calendar","%","%     data.d: vector","%           time-series of directions [degrees]","%","%     data.s: vector","%           time-series of speeds [cm/s]","%","%    width_dir: float","%       Width of directional bins for histogram in degrees","%","%    width_vel: float","%       Width of velocity bins for histogram in m/s","%","%    flood_ebb: 2 element vector (optional)","%       Direction in degrees added to theta ticks","%       to call: plot_joint_probability_distribution(Q, width_dir, width_vel,\"flood_ebb\",flood_ebb)","%","%    title: string (optional)","%       title for the plot","%       to call: plot_joint_probability_distribution(Q, width_dir, width_vel,\"title\",title)","%","%    savepath: string (optional)","%       path and filename to save figure.","%       to call: plot_joint_probability_distribution(Q, width_dir, width_vel,\"savepath\",savepath)","%","% Returns","% ---------","%   figure handle to joint probability distribution plot","%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%","","arguments","    Q","    width_dir","    width_vel","    options.flood_ebb = [];","    options.title = \"\";","    options.savepath = \"\";","","end","","% checking input variables","% if nargin > 5","%     ME = MException('MATLAB:plot_joint_probability_distribution','Incorrect number of input arguments, too many agruments, requires 5 at most, %d arguments passed',nargin);","%     throw(ME);","% end;","","%check to see if the first input argumeent is a structure","if any(~isstruct(Q))","    ME = MException('MATLAB:plot_joint_probability_distribution','Q must be a structure');","    throw(ME);","end;","","%check to see if the second input argumeent is a number","if any([~isnumeric(width_dir), length(width_dir) ~= 1])","    ME = MException('MATLAB:plot_joint_probability_distribution','width_dir must be a number');","    throw(ME);","end;","","%check to see if the second input argumeent is a number","if any([~isnumeric(width_vel), length(width_vel) ~= 1])","    ME = MException('MATLAB:plot_joint_probability_distribution','width_vel must be a number');","    throw(ME);","end;","","% Parsing out the variable arguments","% if nargin >= 4","%     for indx = 4:1:nargin","%         if (ischar(varargin{indx-3}) | isstring(varargin{indx-3}))","%             titleText = varargin{indx-3};","%         elseif isnumeric(varargin{indx-3})","%             if length(varargin{indx-3}) ==2","%                 flood_ebb = varargin{indx-3};","%             end;","%         end;","%     end;","% end;","","% matlab does not have the ability to overlay a pcolor on polar axes, so a","% polar plot must manually be created.","","% Plot Variables","max_rings = 8; % maximum number of anular lines","Vel_label_ang = 80/180*pi; %direction of the velocity lables","pcolorThreshold = 0.05; %threshold for the smallest number to include in pcolor","CMaPType = 'jet';","","% converting degrees to radians","theta = Q.d/180*pi;","","% Calculating the 2D probability","DirEdges = 0:width_dir:360-width_dir;","VelEdges = 0:width_vel:max(Q.s);","[H] = histcounts2(Q.d,Q.s,DirEdges,VelEdges,'Normalization','probability');","H = H*100;","","% creating vel & dir bins index to point to the middle of bin","dir_bins = DirEdges(2:end)-width_dir/2;","dir_bins(1) = 0;","vel_bins = VelEdges(2:end)-width_vel/2;","vel_bins(1) = 0;","","% converting data to cartesian","Xs = Q.s.*sin(theta);","Ys = Q.s.*cos(theta);","","% plotting the scatterpoints","fig = plot(Xs,Ys,'.k');","hold on","set(gca,'xtick',[],'ytick',[]);","","% setting up the axes","% circles","MaxR = round(max(Q.s),1);","rectangle('Position',[-MaxR -MaxR MaxR*2 MaxR*2],'Curvature',[1,1]);","idRng = ceil(length(VelEdges)/max_rings);","for idx = 2:idRng:length(VelEdges)-1","    rectangle('Position',[-VelEdges(idx) -VelEdges(idx) VelEdges(idx)*2 VelEdges(idx)*2],'Curvature',[1,1]);","    text(VelEdges(idx)*sin(Vel_label_ang),VelEdges(idx)*cos(Vel_label_ang),[num2str(VelEdges(idx)) '\\itm/s'],'fontsize',12,'HorizontalAlignment','Center','BackGroundColor','w');","end;","","% radial lines and axis labels","Xrad = MaxR.*sin((0:45:359)/180*pi);","Yrad = MaxR.*cos((0:45:359)/180*pi);","AxisLabel = {'N','NE','E','SE','S','SW','W','NW'};","for idx = 1:8","    line([0 Xrad(idx)],[0 Yrad(idx)]);","    text(Xrad(idx)*1.1,Yrad(idx)*1.05,AxisLabel(idx),'fontsize',15,'HorizontalAlignment','Center');","end","","% adding title","title(options.title)","","% adding in the flood and ebb directions if they are included","if length(options.flood_ebb) == 2","    line([0,MaxR*sin(options.flood_ebb(1)/180*pi)],[0 MaxR*cos(options.flood_ebb(1)/180*pi)]);","    text(MaxR*sin(options.flood_ebb(1)/180*pi)*1.1,MaxR*cos(options.flood_ebb(1)/180*pi)*1.1,'Flood','fontsize',15,'HorizontalAlignment','Center','BackGroundColor','w');","    line([0,MaxR*sin(options.flood_ebb(2)/180*pi)],[0 MaxR*cos(options.flood_ebb(2)/180*pi)]);","    text(MaxR*sin(options.flood_ebb(2)/180*pi)*1.1,MaxR*cos(options.flood_ebb(2)/180*pi)*1.1,'Ebb','fontsize',15,'HorizontalAlignment','Center','BackGroundColor','w');","end","","","% creating direction and velocity matrix as indexes into the probability","% matrix","dir_matrix = ones(size(H)).*(dir_bins'/180*pi);","y_pos = cos(dir_matrix).*vel_bins;","y_pos = [y_pos; y_pos(1,:)];","x_pos = sin(dir_matrix).*vel_bins;","x_pos = [x_pos; x_pos(1,:)];","H = [H;H(1,:)];","","% creating the color plot for the PDF","Hplt = H;","Hplt(H<pcolorThreshold) = nan;","pfig = pcolor(x_pos,y_pos,Hplt);","set(pfig, 'EdgeColor', 'none');","colormap(CMaPType)","shading interp;","cbh = colorbar;","ylabel(cbh,'Joint Probability [%]','fontsize',20);","","len = strlength(options.savepath);","if len > 1","    saveas(figure, options.savepath);","end","","hold off","","","% if nargin == 4","%     title(varargin{1})","% end","",""],"CoverageDisplayDataPerLine":{"Function":[{"LineNumber":1,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":77,"ContinuedLine":false},{"LineNumber":2,"Hits":1,"StartColumnNumbers":40,"EndColumnNumbers":48,"ContinuedLine":true}],"Statement":[{"LineNumber":48,"Hits":1,"StartColumnNumbers":24,"EndColumnNumbers":26,"ContinuedLine":false},{"LineNumber":49,"Hits":1,"StartColumnNumbers":20,"EndColumnNumbers":22,"ContinuedLine":false},{"LineNumber":50,"Hits":0,"StartColumnNumbers":23,"EndColumnNumbers":25,"ContinuedLine":false},{"LineNumber":61,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":20,"ContinuedLine":false},{"LineNumber":62,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":90,"ContinuedLine":false},{"LineNumber":63,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":14,"ContinuedLine":false},{"LineNumber":67,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":55,"ContinuedLine":false},{"LineNumber":68,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":95,"ContinuedLine":false},{"LineNumber":69,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":14,"ContinuedLine":false},{"LineNumber":73,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":55,"ContinuedLine":false},{"LineNumber":74,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":95,"ContinuedLine":false},{"LineNumber":75,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":14,"ContinuedLine":false},{"LineNumber":95,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":14,"ContinuedLine":false},{"LineNumber":96,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":26,"ContinuedLine":false},{"LineNumber":97,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":23,"ContinuedLine":false},{"LineNumber":98,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":17,"ContinuedLine":false},{"LineNumber":101,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":19,"ContinuedLine":false},{"LineNumber":104,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":37,"ContinuedLine":false},{"LineNumber":105,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":32,"ContinuedLine":false},{"LineNumber":106,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":75,"ContinuedLine":false},{"LineNumber":107,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":10,"ContinuedLine":false},{"LineNumber":110,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":39,"ContinuedLine":false},{"LineNumber":111,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":16,"ContinuedLine":false},{"LineNumber":112,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":39,"ContinuedLine":false},{"LineNumber":113,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":16,"ContinuedLine":false},{"LineNumber":116,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":21,"ContinuedLine":false},{"LineNumber":117,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":21,"ContinuedLine":false},{"LineNumber":120,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":23,"ContinuedLine":false},{"LineNumber":121,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":8,"ContinuedLine":false},{"LineNumber":122,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":31,"ContinuedLine":false},{"LineNumber":126,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":25,"ContinuedLine":false},{"LineNumber":127,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":68,"ContinuedLine":false},{"LineNumber":128,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":41,"ContinuedLine":false},{"LineNumber":129,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":36,"ContinuedLine":false},{"LineNumber":130,"Hits":6,"StartColumnNumbers":4,"EndColumnNumbers":108,"ContinuedLine":false},{"LineNumber":131,"Hits":6,"StartColumnNumbers":4,"EndColumnNumbers":177,"ContinuedLine":false},{"LineNumber":135,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":36,"ContinuedLine":false},{"LineNumber":136,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":36,"ContinuedLine":false},{"LineNumber":137,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":50,"ContinuedLine":false},{"LineNumber":138,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":13,"ContinuedLine":false},{"LineNumber":139,"Hits":8,"StartColumnNumbers":4,"EndColumnNumbers":38,"ContinuedLine":false},{"LineNumber":140,"Hits":8,"StartColumnNumbers":4,"EndColumnNumbers":99,"ContinuedLine":false},{"LineNumber":144,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":20,"ContinuedLine":false},{"LineNumber":147,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":33,"ContinuedLine":false},{"LineNumber":148,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":94,"ContinuedLine":false},{"LineNumber":149,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":169,"ContinuedLine":false},{"LineNumber":150,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":94,"ContinuedLine":false},{"LineNumber":151,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":167,"ContinuedLine":false},{"LineNumber":157,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":47,"ContinuedLine":false},{"LineNumber":158,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":34,"ContinuedLine":false},{"LineNumber":159,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":28,"ContinuedLine":false},{"LineNumber":160,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":34,"ContinuedLine":false},{"LineNumber":161,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":28,"ContinuedLine":false},{"LineNumber":162,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":15,"ContinuedLine":false},{"LineNumber":165,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":9,"ContinuedLine":false},{"LineNumber":166,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":30,"ContinuedLine":false},{"LineNumber":167,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":32,"ContinuedLine":false},{"LineNumber":168,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":31,"ContinuedLine":false},{"LineNumber":169,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":18,"ContinuedLine":false},{"LineNumber":170,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":15,"ContinuedLine":false},{"LineNumber":171,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":15,"ContinuedLine":false},{"LineNumber":172,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":50,"ContinuedLine":false},{"LineNumber":174,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":34,"ContinuedLine":false},{"LineNumber":175,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":10,"ContinuedLine":false},{"LineNumber":176,"Hits":1,"StartColumnNumbers":4,"EndColumnNumbers":37,"ContinuedLine":false},{"LineNumber":179,"Hits":1,"StartColumnNumbers":0,"EndColumnNumbers":9,"ContinuedLine":false}]}}