var sourceData6 = {"FileName":"/Users/asimms/Desktop/Programming/mhkit_matlab_simms_dev/MHKiT-MATLAB/mhkit/dolfyn/io/read_h5.m","RawFileContents":["function ds = read_h5(filename)","%%%%%%%%%%%%%%%%%%%%","%     Read H5 data structure.","%","% Parameters","% ------------","%     filename: string","%         Filename of NetCDF file to read.","%","% Returns","% ---------","%     ds: structure","%         Structure from the binary instrument data","%","%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%","","    % check to see if the filename input is a string","    if ~ischar(filename)","        ME = MException('MATLAB:read_h5',['filename must be a ' ...","            'character string']);","        throw(ME);","    end","","    % check to see if the file exists","    if ~isfile(filename)","        ME = MException('MATLAB:read_h5','file does not exist');","        throw(ME);","    end","","    ds = struct();","","    % Get NetCDF info to populate the variable names","    info = h5info(filename);","","    % Check if the file was written by netcdf","    if strcmp(info.Attributes(1).Name,'_NCProperties')","        nc_file = true;","    else","        nc_file = false;","    end","    coord_vals = {};","    coord_keys = [];","","    % Loop through the variables once to get the coords","    var_size = numel(info.Datasets);","    for qq = 1:var_size","        is_coord = false;","        name = info.Datasets(qq).Name;","        path = join(['/',name],\"\");","        dtype = info.Datasets(qq).Datatype.Class;","        attrs = info.Datasets(qq).Attributes;","        for kk=1:numel(attrs)","            if strcmpi(attrs(kk).Name,'CLASS') && ...","                    strcmpi(attrs(kk).Value,'dimension_scale')","                % variable is a coordinate","                is_coord = true;","            elseif strcmpi(attrs(kk).Name,'_Netcdf4Dimid')","                coord_vals(end+1) = {name};","                coord_keys(end+1) = attrs(kk).Value;","            end","        end","        if is_coord","            if strcmp(dtype, 'H5T_STRING')","                % if its a string then we read a string array","                ds.coords.(name) = ...","                    convertStringsToChars(h5read(filename,path));","            else","                if strcmpi(name, 'x*')","                    coord_vals(end) = {'x_star'};","                    ds.coords.x_star = h5read(filename,path);","                else","                    ds.coords.(name) = h5read(filename,path);","                end","            end","        end","    end","","    dim_map = containers.Map(coord_keys,coord_vals);","","    % Loop through the variables again to get the remaining data","    for qq = 1:var_size","        name = info.Datasets(qq).Name;","        path = join(['/',name],\"\");","        attrs = info.Datasets(qq).Attributes;","        sz = info.Datasets(qq).ChunkSize;","        units = 'None';","        dimensions = {};","        if ~any(strcmp(name,coord_vals))","            % variable goes in the main structure field","            for i= 1:numel(attrs)","                if strcmpi(attrs(i).Name,'_Netcdf4Coordinates')","                    dimensions = cell(numel(attrs(i).Value),1);","                    if nc_file","                        count = 1;","                        for jj = numel(attrs(i).Value):-1:1","                            dimensions(count) = ...","                                {dim_map(attrs(i).Value(jj))};","                            count = count + 1;","                        end","                    else","                        for jj = 1:numel(attrs(i).Value)","                            dimensions(jj) = {dim_map(attrs(i).Value(jj))};","                        end","                    end","                elseif strcmpi(attrs(i).Name,'units')","                    if iscell(attrs(i).Value)","                        units = attrs(i).Value{1};","                    elseif isempty(attrs(i).Value)","                        units = \"\";","                    else","                        units = attrs(i).Value;","                    end","                end","            end","            if isempty(dimensions)","                % There should be a way to determine which dimension is","                % correct through the available data but I was unable to","                % determine what that method might be","                dimensions = {'time'};","                if contains(name,'_')","                    split = strsplit(name,'_');","                    if any(strcmp(coord_vals,join(...","                            ['time',\"_\",split{end}],\"\")))","                        dimensions{1} = convertStringsToChars(...","                            join(['time',\"_\",split{end}],\"\"));","                    end","                end","            end","            if numel(sz) == 1","                % no modifications needed (the read function does it)","                ds.(name).data = h5read(filename,path);","            elseif numel(sz) == 2","                if contains(name, 'orientmat') || ...","                        contains(name,'inst2head_rotmat')","                    % no modifications needed","                    ds.(name).data = h5read(filename,path);","                else","                    % Need to reshape the data","                    temp_dat = h5read(filename,path);","                    tmp_shape = size(temp_dat);","                    tmp_shape = [tmp_shape(1),1,tmp_shape(2)];","                    temp_dat = reshape(temp_dat,tmp_shape);","                    ds.(name).data = temp_dat;","                end","            else","                % Need to reshape the data","                temp_dat = h5read(filename,path);","                tmp_shape = size(temp_dat);","                tmp_shape = [tmp_shape(1),1,tmp_shape(2:3)];","                temp_dat = reshape(temp_dat,tmp_shape);","                ds.(name).data = temp_dat;","            end","            ds.(name).dims = dimensions;","            for kk = 1:numel(dimensions)","                ds.(name).coords.(dimensions{kk}) = ...","                    ds.coords.(dimensions{kk});","            end","            ds.(name).units = units;","        end","    end","","    % Finally grab the attributes","    for qq = 1:numel(info.Attributes)","        name = info.Attributes(qq).Name;","        if startsWith(name,'_')","            continue","        end","        value = info.Attributes(qq).Value;","        if isempty(value)","            value = \"\";","        end","        ds.attrs.(name) = value;","    end","","    % Corrections","    if isfield(ds.attrs,'rotate_vars')","        ds.attrs.rotate_vars = cellstr(ds.attrs.rotate_vars);","    end","    if isfield(ds, 'orientation_down')","        ds.orientation_down.data = logical(ds.orientation_down.data);","    end","    if isfield(ds, 'builtin_test_fail')","        ds = rmfield(ds,'builtin_test_fail');","    end","","    ds.coord_sys = ds.attrs.coord_sys;","    ds.time = ds.coords.time;","","end","",""],"CoverageDisplayDataPerLine":{"Function":{"LineNumber":1,"Hits":0,"StartColumnNumbers":0,"EndColumnNumbers":31,"ContinuedLine":false},"Statement":[{"LineNumber":18,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":24,"ContinuedLine":false},{"LineNumber":19,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":63,"ContinuedLine":false},{"LineNumber":20,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":33,"ContinuedLine":true},{"LineNumber":21,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":18,"ContinuedLine":false},{"LineNumber":25,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":24,"ContinuedLine":false},{"LineNumber":26,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":64,"ContinuedLine":false},{"LineNumber":27,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":18,"ContinuedLine":false},{"LineNumber":30,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":18,"ContinuedLine":false},{"LineNumber":33,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":28,"ContinuedLine":false},{"LineNumber":36,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":54,"ContinuedLine":false},{"LineNumber":37,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":23,"ContinuedLine":false},{"LineNumber":39,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":24,"ContinuedLine":false},{"LineNumber":41,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":20,"ContinuedLine":false},{"LineNumber":42,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":20,"ContinuedLine":false},{"LineNumber":45,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":36,"ContinuedLine":false},{"LineNumber":46,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":23,"ContinuedLine":false},{"LineNumber":47,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":25,"ContinuedLine":false},{"LineNumber":48,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":38,"ContinuedLine":false},{"LineNumber":49,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":35,"ContinuedLine":false},{"LineNumber":50,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":49,"ContinuedLine":false},{"LineNumber":51,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":45,"ContinuedLine":false},{"LineNumber":52,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":29,"ContinuedLine":false},{"LineNumber":53,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":48,"ContinuedLine":false},{"LineNumber":54,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":62,"ContinuedLine":true},{"LineNumber":56,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":32,"ContinuedLine":false},{"LineNumber":57,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":58,"ContinuedLine":false},{"LineNumber":58,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":43,"ContinuedLine":false},{"LineNumber":59,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":52,"ContinuedLine":false},{"LineNumber":62,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":19,"ContinuedLine":false},{"LineNumber":63,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":42,"ContinuedLine":false},{"LineNumber":65,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":34,"ContinuedLine":false},{"LineNumber":66,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":65,"ContinuedLine":true},{"LineNumber":68,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":38,"ContinuedLine":false},{"LineNumber":69,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":49,"ContinuedLine":false},{"LineNumber":70,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":61,"ContinuedLine":false},{"LineNumber":72,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":61,"ContinuedLine":false},{"LineNumber":78,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":52,"ContinuedLine":false},{"LineNumber":81,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":23,"ContinuedLine":false},{"LineNumber":82,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":38,"ContinuedLine":false},{"LineNumber":83,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":35,"ContinuedLine":false},{"LineNumber":84,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":45,"ContinuedLine":false},{"LineNumber":85,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":41,"ContinuedLine":false},{"LineNumber":86,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":23,"ContinuedLine":false},{"LineNumber":87,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":24,"ContinuedLine":false},{"LineNumber":88,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":40,"ContinuedLine":false},{"LineNumber":90,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":33,"ContinuedLine":false},{"LineNumber":91,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":63,"ContinuedLine":false},{"LineNumber":92,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":63,"ContinuedLine":false},{"LineNumber":93,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":30,"ContinuedLine":false},{"LineNumber":94,"Hits":0,"StartColumnNumbers":24,"EndColumnNumbers":34,"ContinuedLine":false},{"LineNumber":95,"Hits":0,"StartColumnNumbers":24,"EndColumnNumbers":59,"ContinuedLine":false},{"LineNumber":96,"Hits":0,"StartColumnNumbers":28,"EndColumnNumbers":47,"ContinuedLine":false},{"LineNumber":97,"Hits":0,"StartColumnNumbers":32,"EndColumnNumbers":62,"ContinuedLine":true},{"LineNumber":98,"Hits":0,"StartColumnNumbers":28,"EndColumnNumbers":46,"ContinuedLine":false},{"LineNumber":101,"Hits":0,"StartColumnNumbers":24,"EndColumnNumbers":56,"ContinuedLine":false},{"LineNumber":102,"Hits":0,"StartColumnNumbers":28,"EndColumnNumbers":75,"ContinuedLine":false},{"LineNumber":105,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":53,"ContinuedLine":false},{"LineNumber":106,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":45,"ContinuedLine":false},{"LineNumber":107,"Hits":0,"StartColumnNumbers":24,"EndColumnNumbers":50,"ContinuedLine":false},{"LineNumber":108,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":50,"ContinuedLine":false},{"LineNumber":109,"Hits":0,"StartColumnNumbers":24,"EndColumnNumbers":35,"ContinuedLine":false},{"LineNumber":111,"Hits":0,"StartColumnNumbers":24,"EndColumnNumbers":47,"ContinuedLine":false},{"LineNumber":115,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":34,"ContinuedLine":false},{"LineNumber":119,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":38,"ContinuedLine":false},{"LineNumber":120,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":37,"ContinuedLine":false},{"LineNumber":121,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":47,"ContinuedLine":false},{"LineNumber":122,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":50,"ContinuedLine":false},{"LineNumber":123,"Hits":0,"StartColumnNumbers":28,"EndColumnNumbers":57,"ContinuedLine":true},{"LineNumber":124,"Hits":0,"StartColumnNumbers":24,"EndColumnNumbers":62,"ContinuedLine":false},{"LineNumber":125,"Hits":0,"StartColumnNumbers":28,"EndColumnNumbers":62,"ContinuedLine":true},{"LineNumber":129,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":29,"ContinuedLine":false},{"LineNumber":131,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":55,"ContinuedLine":false},{"LineNumber":132,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":33,"ContinuedLine":false},{"LineNumber":133,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":48,"ContinuedLine":false},{"LineNumber":134,"Hits":0,"StartColumnNumbers":24,"EndColumnNumbers":57,"ContinuedLine":true},{"LineNumber":136,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":59,"ContinuedLine":false},{"LineNumber":139,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":53,"ContinuedLine":false},{"LineNumber":140,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":47,"ContinuedLine":false},{"LineNumber":141,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":62,"ContinuedLine":false},{"LineNumber":142,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":59,"ContinuedLine":false},{"LineNumber":143,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":46,"ContinuedLine":false},{"LineNumber":147,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":49,"ContinuedLine":false},{"LineNumber":148,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":43,"ContinuedLine":false},{"LineNumber":149,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":60,"ContinuedLine":false},{"LineNumber":150,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":55,"ContinuedLine":false},{"LineNumber":151,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":42,"ContinuedLine":false},{"LineNumber":153,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":40,"ContinuedLine":false},{"LineNumber":154,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":40,"ContinuedLine":false},{"LineNumber":155,"Hits":0,"StartColumnNumbers":16,"EndColumnNumbers":51,"ContinuedLine":false},{"LineNumber":156,"Hits":0,"StartColumnNumbers":20,"EndColumnNumbers":47,"ContinuedLine":true},{"LineNumber":158,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":36,"ContinuedLine":false},{"LineNumber":163,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":37,"ContinuedLine":false},{"LineNumber":164,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":40,"ContinuedLine":false},{"LineNumber":165,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":31,"ContinuedLine":false},{"LineNumber":166,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":21,"ContinuedLine":false},{"LineNumber":168,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":42,"ContinuedLine":false},{"LineNumber":169,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":25,"ContinuedLine":false},{"LineNumber":170,"Hits":0,"StartColumnNumbers":12,"EndColumnNumbers":23,"ContinuedLine":false},{"LineNumber":172,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":32,"ContinuedLine":false},{"LineNumber":176,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":38,"ContinuedLine":false},{"LineNumber":177,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":61,"ContinuedLine":false},{"LineNumber":179,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":38,"ContinuedLine":false},{"LineNumber":180,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":69,"ContinuedLine":false},{"LineNumber":182,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":39,"ContinuedLine":false},{"LineNumber":183,"Hits":0,"StartColumnNumbers":8,"EndColumnNumbers":45,"ContinuedLine":false},{"LineNumber":186,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":38,"ContinuedLine":false},{"LineNumber":187,"Hits":0,"StartColumnNumbers":4,"EndColumnNumbers":29,"ContinuedLine":false}]}}